{% extends 'base.html' %}

{% block title %}Cotação de Ativos{% endblock %}

{% block content %}
{% if user.is_authenticated %}
  Hi {{ user.username }}!
  <p><a href="{% url 'logout' %}">Log Out</a></p>
  <p><a href="{% url 'password_reset' %}">Reset Password</a></p>
  <div class="container">
    <h2>Cotação de Ativos da B3</h2>
      {% if saved %}
        <ul class="cards">
          {% for ativo in saved %}
            <li class="card">
              <div>
                <h3 class="card-title">{{ativo.ticker}}</h3>
                <div class="card-subtitle">
                  <p>{{ativo.name}}</p>
                </div>
                <div class="card-price{% if ativo.change_percent >= 0 %}-positive{% endif %}">
                  <p>{{ativo.currency_symbol}} {{ativo.price|floatformat:2}}</p>
                  <div class="card-price-change">
                    ({% if ativo.change_percent >= 0 %}+{% endif %}{{ativo.change_percent|floatformat:2}}%)
                  </div>
                </div>
              </div>
              <div class="card-link-wrapper">
                <a href="{% url 'monitor' ativo.ticker %}" class="card-link">Monitoramento</a>
              </div>
            </li>
          {% endfor %}
        </ul>
      {% else %}
        <h2>Selecione o código de um ativo para salvá-lo.</h2>
      {% endif %}
    <div class="table-container">
      <table class="styled-table">
        <thead>
          <tr>
              <th class="string-cell">Código</th>
              <th class="string-cell">Nome</th>
              <th class="value-cell">Último Fechamento</th>
              <th class="value-cell">Abertura</th>
              <th class="value-cell">Cotação</th>
              <th><span></span></th>
          </tr>
        </thead>
        <tbody>
          {% for ativo in api %}
            <tr>
                <td>
                  <div class="table-link-wrapper">
                    <a href="{% url 'add' ativo.ticker %}" class="table-link">{{ativo.ticker}}</a>
                  </div>
                </td>
                <td>{{ativo.name}}</td>
                <td>{{ativo.currency_symbol}} {{ativo.previous_close|floatformat:2}}</td>
                <td>{{ativo.currency_symbol}} {{ativo.open|floatformat:2}}</td>
                <td>{{ativo.currency_symbol}} {{ativo.price|floatformat:2}}</td>
                <td class="color_change{% if ativo.change_percent >= 0 %}_positive{% endif %}">({% if ativo.change_percent >= 0 %}+{% endif %}{{ativo.change_percent|floatformat:2}}%)</td>
            </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
  

{% else %}
  <p>You are not logged in</p>
  <a href="{% url 'login' %}">Log In</a>
{% endif %}
{% endblock %}
